<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>Gomba Moderátor Felület</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f5f5f5; }
        .card {
            background: white;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
        }
        img { max-width: 300px; border-radius: 5px; }
        button {
            padding: 8px 12px;
            margin-right: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .approve { background: #4CAF50; color: white; }
        .reject { background: #d9534f; color: white; }
    </style>
</head>
<body>

<h1>Gomba Moderátor Felület</h1>
<p>Itt tudod jóváhagyni vagy javítani a gombákat.</p>

<div id="list"></div>

<script>
async function loadPending() {
    const res = await fetch("/api/admin/pending")
    const data = await res.json()

    const list = document.getElementById("list")
    list.innerHTML = ""

    data.forEach(item => {
        const div = document.createElement("div")
        div.className = "card"

        div.innerHTML = `
            <img src="${item.image_url}" alt="gomba">
            <p><b>Javasolt név:</b> ${item.species}</p>
            <p><b>Bizonyosság:</b> ${item.confidence}%</p>
            <p><b>Koordináták:</b> ${item.latitude}, ${item.longitude}</p>
            <input id="name-${item.id}" type="text" value="${item.species}" style="width:200px;">
            <br><br>
            <button class="approve" onclick="approve(${item.id})">Jóváhagyás</button>
            <button class="reject" onclick="reject(${item.id})">Elutasítás</button>
        `

        list.appendChild(div)
    })
}

async function approve(id) {
    const name = document.getElementById("name-" + id).value

    await fetch("/api/admin/approve/" + id, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            corrected_species: name,
            admin_name: "Admin",
            action: "approve"
        })
    })

    loadPending()
}

async function reject(id) {
    const name = document.getElementById("name-" + id).value

    await fetch("/api/admin/approve/" + id, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            corrected_species: name,
            admin_name: "Admin",
            action: "reject"
        })
    })

    loadPending()
}

loadPending()
</script>

</body>
</html>
